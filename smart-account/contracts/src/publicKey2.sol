// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.23;

import {Dilithium, PolynomialVector, Polynomial, K} from "@tetrationlab/dilithium/Dilithium.sol";
import {IPolyVector} from "./IPolyVector.sol";

interface IDilithiumPublicKey {
    function expandedPublicKey() external view returns (Dilithium.ExpandedPublicKey memory);
}

contract DilithiumPublicKey is IDilithiumPublicKey {
    using Polynomial for Polynomial.Poly;
    using PolynomialVector for PolynomialVector.PolyVecK;
    using PolynomialVector for PolynomialVector.PolyVecL;

    IPolyVector public vecMat0;
    IPolyVector public vecMat1;
    IPolyVector public vecMat2;
    IPolyVector public vecMat3;
    constructor(
        address _mat0,
        address _mat1,
        address _mat2,
        address _mat3
    ) {
        vecMat0 = IPolyVector(_mat0);
        vecMat1 = IPolyVector(_mat1);
        vecMat2 = IPolyVector(_mat2);
        vecMat3 = IPolyVector(_mat3);
    }

    function expandedPublicKey() external view override returns (Dilithium.ExpandedPublicKey memory epk) {
        bytes32 packed = hex"16451eb2801d04514460c0ffe3635a4d22aa461ff815b19a73c3bcfc9a5eda7e";
        PolynomialVector.PolyVecK memory t1;
        Polynomial.Poly memory t1_0 = Polynomial.Poly([int32(-5121263),54033,-7442521,-4137825,3497062,5728870,6750122,-961086,-14383286,-10868578,-6091021,-7970707,-2564181,-5797809,-820663,-8980171,-12151907,-8722563,-2766044,-10843794,-4755350,593322,-13896029,-6446643,2608321,75193,-1938914,6452388,-3043385,556545,-8524787,-5884673,4190875,-2345417,1760324,9046410,5116957,-1354855,4306288,11697962,-6592439,884211,1607138,808938,4423226,9051976,4067670,6030256,-3977582,1051966,-824781,3330217,-6285421,-1986781,-4264749,337275,-1927039,4272315,12054524,4258092,3753154,2689232,10472441,6136769,2790575,7770719,-995147,230793,13045706,11390144,5651503,3353595,589430,8836286,8894279,15334857,-5918782,1188880,2033943,4360531,7702716,11997094,1654550,1651892,828375,-295931,5157998,9420730,-4345093,1774273,-4072126,-325226,-1454275,-1216351,6959790,7026576,1535221,-2342233,-1980412,4797568,4995437,9708843,-2308665,4050609,5171879,6204379,5181403,11975183,9325715,16012907,7399845,7569425,10603571,3330185,2547056,1423640,7838594,6086872,-1244476,5066734,8852535,13207499,4212361,8492645,5102309,639571,138245,1686611,-4506358,657544,-3853767,4429113,-7229723,-3525017,-1592395,4401723,-10134020,-5391262,-6134032,-13626474,-1396234,-657040,-5309098,-6226176,-1198226,1357888,3234160,2589682,-2128647,4262255,1777993,3622695,5709658,2839944,884802,5857388,5180,4021316,-27644,-7879580,-6783815,-1331259,2704652,5184810,9483436,4487628,4133810,-1711078,-3814699,-6901617,2134748,-106932,-12535976,-6981130,-2913361,-10810529,-819658,-908186,3866455,2293657,-5307955,-9449217,523588,-2718252,3205636,4965302,-1441172,-2647310,-12755221,-4563483,150340,-1176188,8901846,3688526,5045532,7997912,4814083,761861,7452363,5957845,5795164,6261914,5896453,9905781,-1184181,5028331,7767927,4906387,12773209,12396183,7845352,4055608,11459742,8966454,5299742,9477678,-311512,7353296,9127456,4707792,6329164,11405988,90372,7534468,6711627,14468621,6242398,11770138,11257769,12105721,14943800,20626502,8870463,8756077,760640,8600288,11196870,18043376,9021856,4704078,4005748,-981508,12317143,5075825,2120703,4307355,7374709,2612417,2896340,2874056,1536982,-6589738,-2824946,4402142,3253108,6159664]);
        Polynomial.Poly memory t1_1 = Polynomial.Poly([int32(7746883),-177145,-6005631,2091441,1945847,-3688755,179479,6311113,-404087,-8525323,-1404930,-1352620,-13424315,-7456453,-5219327,-3993057,1564389,1395221,5557466,8900864,-3133544,-1007442,-5635221,385195,7974950,8066314,7339426,2820554,3096768,4666880,11384569,10759947,-2687418,114450,124765,-2475997,4472747,7293985,-1609104,5674884,7193202,10303444,2775648,4551782,-3041332,2582648,2730325,8576323,2282037,3070075,-5477793,-1365931,1072852,7894000,4328504,10437728,8551118,2583602,5936867,5429665,7878939,15413451,13053125,8892529,10363497,3931493,4137744,7103182,14340596,13463292,8585921,4008659,2728268,364342,4731332,7823398,2437318,7203724,1466647,6074843,4712484,4527348,3051764,9227344,10217627,14579239,7919847,7601195,10905074,16520336,11688707,5610715,5150130,2689166,10902075,4727253,-6433637,-1477407,5124012,-2704180,-4410410,-467328,6314157,2707073,-3765718,-4816998,-6054431,-1929289,5935265,2081327,-3461703,-2974125,4126766,11197766,4826458,6027574,182975,-299581,3815845,6444277,12806578,7561994,7515315,4424785,-926559,-807751,3524528,-2836442,1886540,-3220668,-965714,-4294174,242005,7230307,614942,-6990422,-9976173,-14267297,-14325142,-7342636,-6231569,682109,-5196617,-7702307,-1937943,-6942245,-6854071,-967749,-12832895,-11129993,-2351143,-9144265,6677605,7422177,-2366589,1464583,-836630,3746066,-3091827,-7132281,-15473850,-8898312,-18616918,-15365852,-4460888,-6453136,-14129038,-7332646,-3366618,-10539258,-8490709,-832683,-2211509,-1683781,660316,672610,5469002,977856,-3076570,-4727880,4278034,-1946574,12349090,5780426,-6528820,-9665832,2213057,-3817161,5303225,-1050477,-4502173,-3328451,-5001750,-3657486,-2275169,-10414467,5758645,-1157877,714939,1339821,-4082868,-445628,7491587,684113,4932981,-354131,2353958,337748,4299854,7168742,3580534,10212394,9464692,15448804,11583299,18659665,8041017,4134681,1775335,2188115,4254847,8457347,8279867,187927,-2043973,-1407277,5966191,-1434361,-6634435,-1350993,-12705701,-6812051,-7743267,-6058569,-3064255,2198547,-8649744,-7249982,-5405935,-3983363,3472055,2321601,-289964,-6153716,8224871,8107177,-2431096,3186392,10337588,8519298,5118835,6461043,7052058,1149082,-3477375,2955847]);
        Polynomial.Poly memory t1_2 = Polynomial.Poly([int32(3789279),9823061,11451560,4453048,10816998,12162476,8787454,3738212,-737149,1115487,2317468,3358654,6120890,5037924,12592151,7068855,13394542,14695402,19898788,21620148,7999910,13461672,9076960,11511866,11292185,11936547,12920434,17918090,13552488,6531554,5948178,-2087132,8151591,15808977,6458727,12648009,9309282,6858708,9274042,16560392,9217747,9808125,7463879,3588001,7140324,7297758,5552798,-1169752,3052476,7091846,16041149,8271841,4642764,9140650,12895014,7764324,3925972,11306116,11244522,13922390,19417540,12992426,17210147,23669079,14904488,8903550,2146332,5619774,19283026,14378686,14679430,16200258,13278004,17970148,10282231,15483601,12796028,14280608,8427470,2558014,7043716,8164638,12290362,9908068,614754,1300986,5994912,2229396,-3444037,4452513,-2587513,-4487695,-2705754,4672330,7959621,8156455,-10503422,-4113334,-990308,-4993832,1013208,8091766,-29739,-2959747,124184,-3611122,1003040,-468014,-4813518,-2331864,-3596594,-11449424,5655166,5344260,2456197,1924117,-2947889,4172139,4808245,3960941,7402144,11033228,3973939,1604669,-820851,3930157,-251801,-7815845,10866567,17517281,7141720,5593844,3490268,3375248,3845056,-690512,3055119,-316239,-2497705,-7092903,2000487,235587,-5923613,2318595,4894382,10460376,5410910,7446980,5678453,4463341,6513825,10844845,-718730,-4775850,91946,-6129914,3361935,-530241,3634022,11980200,-873094,1938970,6129653,1287007,1949136,-1602036,-2548065,-10163107,4439535,10823815,-2001215,2041437,-390695,2535339,-8657775,-5115609,7253383,4460533,3202284,7768592,262603,7610141,1406238,-5388142,-1972946,-1857134,4724441,4930379,-3706871,-6460563,-3886317,-9045005,11203102,6240580,11195914,14768056,1418236,1069674,8222062,3139720,-4664064,-5701952,3822832,-622912,6873380,-451826,-3749935,1195037,1841712,7349064,3242585,4625395,3362874,-3412126,479395,3086213,4138121,-147823,-2598983,-4254063,-1184378,350678,-2629382,5490990,-7932028,-1376554,-4435828,-6215006,-75230,7223268,676591,-1280853,3714922,3124564,-222717,-3526381,3425308,1941520,4587868,-3530596,8033934,14808650,10973215,5926833,6582333,14263467,6728514,1430950,6586695,-1797619,2138976,1411248,-886765,-4017837,1635743,6332863]);
        Polynomial.Poly memory t1_3 = Polynomial.Poly([int32(8831512),16669962,3255909,11314141,246909,5297733,6424184,5862650,1608573,1486915,8808798,8065754,9211595,6968637,2357171,3197701,7849427,602007,560038,5959640,5865753,9120315,3402885,-734129,6936551,13816759,5988057,3474433,-1663683,1058433,8879697,3551833,5192755,11899883,7526775,14890427,7373104,9638812,10554639,7305613,1971850,-3388500,1461522,3136816,9278371,3334555,3326115,553343,7158559,9069889,5892362,309654,11581865,8744401,12017778,19993132,11626458,5432550,2700102,2461270,9295066,7013150,11003804,10422760,2382742,7387858,10711695,4464653,13317073,9338153,12682481,8807281,13619183,16576777,16396618,16781486,14548530,18735250,23432726,15614246,11831311,12685459,10503655,9350735,10841546,4290780,4770906,8362264,7473780,10170170,1231233,120761,15788488,8433638,3307421,8641229,1043956,7892444,4144804,-2787468,-1242800,-9500032,6760965,-1028733,-221799,5100271,2568864,-4515340,5279520,-2901540,5199119,2626089,-1489101,-3473663,7013918,758206,6960814,1599504,-3261316,270958,10970467,5997197,15811824,9268044,2083675,4584353,2463702,5469370,-343909,-620891,3420238,793422,2853237,-3899819,-3441263,4367065,-523171,-2840941,4190946,3456754,980342,-6604190,6313408,2562244,-4754955,1551511,-1593669,3321577,2245040,3310736,-3103196,-3004660,496530,8856606,4973494,4367970,12147131,3826099,6041429,4325829,7675694,4631032,9360138,2367324,-1735197,1295307,5372598,262656,2351976,-219900,-2123987,-7329893,-2644702,-2316118,8032054,-68998,1004778,9376186,2125685,731867,7274541,3068011,4369806,484846,1337641,-1765233,7394959,5271849,-3128621,1509605,8596155,3584597,-5523738,-5837298,-5895605,-9920799,-7976226,-5237898,-4277060,-6014776,-8932134,-9334270,-5733629,-5321035,-9399498,-6086352,1427323,-320157,5424140,4530262,6333827,553875,-9565265,-4826245,1652678,-2756592,-8888170,-5008926,-2120294,-7933450,1407897,1538157,-10461404,-3038970,5514581,-1977889,-3190165,-4658415,-1236349,-3189153,-8621826,-9729592,-6547775,-4150111,-2309803,208117,-5698461,-13827039,-8226598,-15686210,-1013596,-4952040,-4860255,-6708005,9976976,3382482,-2819985,4671439,-5623527,-9020765,-2904061,-11112927,-2105915,-6540865,-14337616,-8799116]);
        t1 = PolynomialVector.PolyVecK([t1_0, t1_1, t1_2, t1_3]);
        PolynomialVector.PolyVecL[K] memory mat;
        PolynomialVector.PolyVecL memory mat0 = vecMat0.constructMat();
        PolynomialVector.PolyVecL memory mat1 = vecMat1.constructMat();
        PolynomialVector.PolyVecL memory mat2 = vecMat2.constructMat();
        PolynomialVector.PolyVecL memory mat3 = vecMat3.constructMat();
        mat = [mat0, mat1, mat2, mat3];
        epk.packed = packed;
        epk.mat = mat;
        epk.t1 = t1;
    }
}